ğŸš€ ORIENTAÃ‡ÃƒO OFICIAL
ğŸ§  Projeto: MedIntelli â€“ VersÃ£o ProduÃ§Ã£o
ğŸ Objetivo:

Gerar, configurar e publicar o sistema completo (Sistema Principal + App Paciente + Painel DiagnÃ³stico) em ambiente real de produÃ§Ã£o, com todas as integraÃ§Ãµes ativas (Supabase, Avisa API, OpenAI, etc.) e 100% funcionalidade.

ğŸ§© 1ï¸âƒ£ PREPARAÃ‡ÃƒO DO AMBIENTE
ğŸ—‚ï¸ Estrutura final do projeto

O projeto deve conter:

src/
 â”œâ”€â”€ pages/
 â”‚    â”œâ”€â”€ index.tsx
 â”‚    â”œâ”€â”€ login.tsx
 â”‚    â”œâ”€â”€ dashboard.tsx
 â”‚    â”œâ”€â”€ agenda.tsx
 â”‚    â”œâ”€â”€ fila-espera.tsx
 â”‚    â”œâ”€â”€ pacientes.tsx
 â”‚    â”œâ”€â”€ usuarios.tsx
 â”‚    â”œâ”€â”€ mensagens-app.tsx
 â”‚    â”œâ”€â”€ mensagens-whatsapp.tsx
 â”‚    â”œâ”€â”€ feriados.tsx
 â”‚    â”œâ”€â”€ dashboard-medico.tsx
 â”‚    â”œâ”€â”€ app-paciente/
 â”‚    â”‚      â”œâ”€â”€ index.tsx
 â”‚    â”‚      â”œâ”€â”€ agendamento.tsx
 â”‚    â”‚      â”œâ”€â”€ historico.tsx
 â”‚    â”‚      â”œâ”€â”€ chat.tsx
 â”‚    â”‚      â”œâ”€â”€ exames.tsx
 â”‚    â”‚      â””â”€â”€ perfil.tsx
 â”‚    â”œâ”€â”€ diagnostics-full.tsx   âœ…
 â”‚    â””â”€â”€ _app.tsx
 â”œâ”€â”€ lib/
 â”‚    â””â”€â”€ supabaseClient.ts
 â”œâ”€â”€ styles/
 â”‚    â””â”€â”€ globals.css
 â”œâ”€â”€ public/
 â”‚    â”œâ”€â”€ favicon.ico
 â”‚    â””â”€â”€ logo.png
 â””â”€â”€ package.json

âš™ï¸ 2ï¸âƒ£ CONFIGURAÃ‡ÃƒO DO AMBIENTE .env

Crie o arquivo .env.production (ou .env.local se o Minimax usar build direto) com:

VITE_SUPABASE_URL=https://<seu-projeto>.supabase.co
VITE_SUPABASE_ANON_KEY=<sua_chave_anon>
VITE_OPENAI_KEY=<sua_chave_openai>
VITE_AVISA_API_URL=https://api.avisa.app
VITE_AVISA_API_KEY=<sua_chave_avisa>
VITE_BUILD_ID=PRODUCAO-<data>-<versao>


âœ… Verifique que as chaves pertencem Ã  instÃ¢ncia real (nÃ£o Sandbox) do Supabase e Avisa API.
âœ… Verifique se a OpenAI KEY Ã© vÃ¡lida e com billing ativo.

ğŸ§± 3ï¸âƒ£ SUPABASE â€“ CONFIGURAÃ‡ÃƒO DE PRODUÃ‡ÃƒO
Banco e Edge Functions

Crie um novo projeto no painel do Supabase
.

Importe o schema final (caso ainda nÃ£o tenha):

supabase db push


ou cole manualmente o SQL fornecido (schema.sql) no SQL Editor.

Implemente as Edge Functions:

supabase functions deploy agendamentos
supabase functions deploy fila-espera
supabase functions deploy pacientes
supabase functions deploy whatsapp-send-message
supabase functions deploy mensagens-app
supabase functions deploy mensagens-whatsapp
supabase functions deploy feriados
supabase functions deploy base-conhecimento
supabase functions deploy usuarios
supabase functions deploy dashboard-medico


Ative CORS e autenticaÃ§Ã£o:

Em API Settings, adicione:

Allowed Origins: https://<dominio-final>


Em Auth Settings, habilite email/password login.

ğŸ’¬ 4ï¸âƒ£ INTEGRAÃ‡ÃƒO WHATSAPP â€“ AVISA API
ConfiguraÃ§Ã£o do Webhook

No painel da Avisa API, configure o endpoint:

https://<dominio-final>/functions/v1/whatsapp-send-message


Habilite o webhook de recebimento de mensagens e respostas automÃ¡ticas.

Teste rÃ¡pido:

Envie mensagem de teste para o nÃºmero de WhatsApp configurado.

Verifique se aparece em Painel â†’ Mensagens WhatsApp.

Verifique se o agente de IA responde corretamente (OpenAI ativo).

ğŸ§  5ï¸âƒ£ OPENAI â€“ BASE DE CONHECIMENTO

Verifique se a tabela knowledge_base contÃ©m o arquivo Ãºnico de conhecimento.

A funÃ§Ã£o base-conhecimento deve buscar os dados da tabela e responder via API OpenAI:

const prompt = "Paciente pergunta: " + mensagem;
const resposta = await openai.chat.completions.create({
  model: "gpt-4-turbo",
  messages: [{ role: "system", content: "Use a base de conhecimento MedIntelli." }, { role: "user", content: prompt }],
});


O diagnÃ³stico /diagnostics-full mostrarÃ¡ ğŸŸ¢ â€œBase de Conhecimento OKâ€.

ğŸŒ 6ï¸âƒ£ BUILD FINAL DE PRODUÃ‡ÃƒO

No Minimax:

Abra o projeto e selecione Build > Ambiente de ProduÃ§Ã£o (Production).

Verifique que o .env.production estÃ¡ sendo usado.

Execute:

npm run build
npm run start


Gere o link final:

https://medintelli.space.minimax.io/

ğŸ§­ 7ï¸âƒ£ TESTES DE ACEITAÃ‡ÃƒO FINAL
Testes automÃ¡ticos:

Acesse /diagnostics-full â†’ tudo deve estar ğŸŸ¢

FaÃ§a login com cada usuÃ¡rio:

SuperAdmin: acesso total

MÃ©dico: vÃª alertas de novos exames e mensagens

SecretÃ¡ria: consegue agendar e gerenciar fila

Auxiliar: consegue responder mensagens e anexar exames

Testes manuais:

Crie paciente novo (com convÃªnio permitido).

Agende consulta via App Paciente.

Verifique se aparece no Sistema Principal (Agenda).

Envie mensagem via WhatsApp e verifique resposta da IA.

Marque um feriado e veja se aparece na Agenda.

Reordene a fila por arrastar â†’ deve gravar corretamente.

ğŸ§¾ 8ï¸âƒ£ CHECKLIST FINAL DE ENTREGA
Item	Status esperado
âœ… Supabase conectado	.env ok e Edge Functions ativas
âœ… OpenAI ativo	IA responde no App Paciente e WhatsApp
âœ… Avisa API conectada	Mensagens enviadas/recebidas
âœ… Agenda	Cria, edita, move e exibe agendamentos
âœ… Fila de espera	Arrasta, edita, converte em agendamento
âœ… Pacientes	CRUD completo e convÃªnios corretos
âœ… UsuÃ¡rios	Cadastro, ediÃ§Ã£o e controle de perfil
âœ… Feriados	Grava, sincroniza e aparece na agenda
âœ… Dashboard MÃ©dico	Exibe alertas e contagens corretas
âœ… DiagnÃ³stico Full	Todos os mÃ³dulos ğŸŸ¢
ğŸ 9ï¸âƒ£ PÃ“S-DEPLOY

Adicione no menu SuperAdmin:

DiagnÃ³stico â†’ /diagnostics-full


Gere backup completo do banco no Supabase.

Marque versÃ£o e data do build no rodapÃ©:

VersÃ£o: MedIntelli 1.0 â€“ Build ProduÃ§Ã£o YYYY-MM-DD


ğŸ’¡ Em resumo:
ğŸ‘‰ VocÃª deve manter os dois arquivos (diagnostics-full.tsx e diagnostics-fix.json),
ğŸ‘‰ configurar o .env real com as chaves de produÃ§Ã£o,
ğŸ‘‰ e fazer build fora do Sandbox, com Supabase, OpenAI e Avisa API reais