abaixo est√° o JSON de ‚Äúroteiro de corre√ß√£o automatizado‚Äù, pronto para voc√™ anexar ao Minimax junto com o diagnostics-full.tsx.
ele serve para que o Minimax corrija sozinho tudo o que o painel de diagn√≥stico detectar como ‚Äúamarelo‚Äù (üü°) ou ‚Äúvermelho‚Äù (üî¥).
voc√™ pode salvar esse conte√∫do como diagnostics-fix.json e anexar no campo de instru√ß√µes complementares do Minimax.

üìÑ diagnostics-fix.json
{
  "project": "MedIntelli ‚Äì Diagn√≥stico Total",
  "goal": "Executar corre√ß√µes autom√°ticas conforme status de diagn√≥stico (üü°/üî¥). Garantir sistema 100% funcional com Supabase, Avisa API e OpenAI.",
  "workflow": [
    {
      "module": "ENVIRONMENT",
      "if": "üî¥ ou vari√°vel ausente",
      "action": [
        "Verificar .env e garantir chaves:",
        "VITE_SUPABASE_URL=https://<projeto>.supabase.co",
        "VITE_SUPABASE_ANON_KEY=<chave-anon>",
        "VITE_OPENAI_KEY=<chave-openai>",
        "VITE_AVISA_API_URL=https://api.avisa.app",
        "VITE_AVISA_API_KEY=<chave-avisa>"
      ],
      "note": "Sem essas vari√°veis, o sistema n√£o inicializa corretamente."
    },
    {
      "module": "AUTH_SESSION",
      "if": "sem sess√£o ativa",
      "action": [
        "Verificar Supabase Auth.",
        "Confirmar que a tabela 'usuarios' possui perfis SuperAdmin, M√©dico, Auxiliar e Secret√°ria.",
        "Validar pol√≠tica de Row Level Security (RLS) para usu√°rios."
      ]
    },
    {
      "module": "EDGE_FUNCTIONS",
      "if": "alguma fun√ß√£o retorna erro 404 ou 500",
      "action": [
        "Executar novamente o deploy das Edge Functions:",
        "supabase functions deploy agendamentos",
        "supabase functions deploy whatsapp-send-message",
        "supabase functions deploy fila-espera",
        "supabase functions deploy pacientes",
        "supabase functions deploy feriados",
        "supabase functions deploy mensagens-app",
        "supabase functions deploy mensagens-whatsapp",
        "supabase functions deploy base-conhecimento",
        "supabase functions deploy usuarios",
        "supabase functions deploy dashboard-medico"
      ],
      "note": "Ap√≥s deploy, limpar cache e reconstruir projeto no Minimax."
    },
    {
      "module": "DATABASE",
      "if": "tabelas retornam vazias ou erro",
      "action": [
        "Criar tabelas se n√£o existirem:",
        "agendamentos, fila_espera, pacientes, usuarios, feriados, mensagens_app, whatsapp_messages, knowledge_base",
        "Rodar scripts SQL conforme schema atual do MedIntelli.",
        "Verificar policies de RLS para cada tabela.",
        "Adicionar √≠ndices em colunas de data para melhorar performance."
      ]
    },
    {
      "module": "KNOWLEDGE_BASE",
      "if": "sem base de conhecimento",
      "action": [
        "Criar tabela knowledge_base (id, titulo, tipo, conteudo, atualizado_em).",
        "Inserir arquivo √∫nico de conhecimento consolidado.",
        "Garantir leitura via OpenAI completions.",
        "Configurar agente de IA para buscar respostas nesse arquivo antes de fallback ao modelo."
      ]
    },
    {
      "module": "DASHBOARD_MEDICO",
      "if": "sem contagem ou erro de dados",
      "action": [
        "Verificar tabelas mensagens_app e agendamentos.",
        "Garantir colunas status e tipo ('exame', 'mensagem', etc).",
        "Adicionar trigger para alertar m√©dico em novos exames ou mensagens.",
        "Corrigir Dashboard M√©dico para exibir alertas em tempo real."
      ]
    },
    {
      "module": "FERIADOS",
      "if": "erro ou looping na tela de feriados",
      "action": [
        "Corrigir Edge Function feriados.",
        "Garantir grava√ß√£o correta e recorr√™ncia anual.",
        "Sincronizar feriados nacionais via OpenAI API ou API p√∫blica (BrasilAPI)."
      ]
    },
    {
      "module": "AGENDAMENTOS",
      "if": "erro 500 ao criar agendamento",
      "action": [
        "Corrigir fun√ß√£o edge agendamentos: validar paciente_id e data_hora.",
        "Permitir criar paciente r√°pido (nome, telefone, conv√™nio) no momento do agendamento.",
        "Confirmar que agenda salva no Supabase e reflete em tempo real na interface."
      ]
    },
    {
      "module": "FILA_ESPERA",
      "if": "erro ao adicionar paciente ou ordem n√£o arrasta",
      "action": [
        "Corrigir endpoint fila-espera.",
        "Permitir drag and drop para reordenar.",
        "Implementar ordena√ß√£o por prioridade + ordem de chegada.",
        "Remover paciente da fila ap√≥s agendamento."
      ]
    },
    {
      "module": "PACIENTES",
      "if": "n√£o carrega, salva ou edita",
      "action": [
        "Habilitar CRUD completo: busca, altera√ß√£o, exclus√£o, ativar/inativar.",
        "Validar conv√™nios aceitos (Unimed, Unif√°cil, Cassi, Cabesp).",
        "Ajustar tela para responsividade e melhor navegabilidade."
      ]
    },
    {
      "module": "USUARIOS",
      "if": "looping ou erro ao salvar",
      "action": [
        "Corrigir submit handler em /usuarios.",
        "Adicionar toast de sucesso e recarregar lista.",
        "Resolver pol√≠ticas de acesso por perfil (SuperAdmin, M√©dico, Auxiliar, Secret√°ria)."
      ]
    },
    {
      "module": "WHATSAPP",
      "if": "mensagens n√£o carregam ou falham",
      "action": [
        "Configurar webhook ativo do Avisa API.",
        "Testar POST /whatsapp-send-message.",
        "Registrar mensagens no painel de mensagens.",
        "Verificar token e endpoint Avisa API no .env.",
        "Confirmar IA respondendo e agendando consultas via WhatsApp."
      ]
    },
    {
      "module": "MENSAGENS_APP_PACIENTE",
      "if": "mensagens em looping ou n√£o aparecem",
      "action": [
        "Corrigir renderiza√ß√£o e cache das mensagens no painel.",
        "Garantir registro no Supabase (tabela mensagens_app).",
        "Sincronizar com dashboard principal e permitir encaminhar ao m√©dico.",
        "IA (OpenAI) deve responder com contexto e continuidade."
      ]
    },
    {
      "module": "PERFORMANCE",
      "if": "carregamento lento ou loopings frequentes",
      "action": [
        "Ativar cache leve com SWR/React Query.",
        "Evitar loops em useEffect sem depend√™ncias corretas.",
        "Usar suspense e lazy loading em listas longas.",
        "Compress√£o Gzip habilitada no deploy final."
      ]
    },
    {
      "module": "UI_LAYOUT",
      "if": "layout desalinhado ou pouco moderno",
      "action": [
        "Atualizar menu superior para layout responsivo.",
        "Adicionar cores, √≠cones e feedback visual nos bot√µes.",
        "Modernizar APP Paciente (tons suaves + navega√ß√£o intuitiva).",
        "Inserir bot√£o 'Voltar' em todas as telas do app."
      ]
    }
  ],
  "final_step": [
    "Reexecutar /diagnostics-full ap√≥s cada corre√ß√£o.",
    "Quando todos os m√≥dulos estiverem üü¢, gerar build final no Minimax.",
    "Registrar vers√£o do sistema e build ID no painel SuperAdmin."
  ]
}

üß© Como usar

Anexe o arquivo diagnostics-fix.json ao projeto no Minimax (campo ‚Äúinstru√ß√µes complementares‚Äù).

Deixe claro que ele deve seguir automaticamente o roteiro, corrigindo qualquer m√≥dulo que apare√ßa como üü°/üî¥.

Ap√≥s o processo, abra /diagnostics-full ‚Äî todos os m√≥dulos precisam estar üü¢.

Quando isso ocorrer, o sistema estar√° 100% funcional, com IA, WhatsApp, agenda e base de conhecimento integradas.